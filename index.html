<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ministry Auditorium Booking System</title>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #e74c3c;
            --accent: #3498db;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --success: #2ecc71;
            --warning: #f39c12;
            --danger: #e74c3c;
            --disabled: #95a5a6;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--dark) 100%);
            color: white;
            padding: 2rem;
            text-align: center;
        }
        
        h1 {
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
        }
        
        .tab {
            padding: 1rem 1.5rem;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }
        
        .tab.active {
            background: white;
            border-bottom: 3px solid var(--accent);
            color: var(--accent);
        }
        
        .tab-content {
            display: none;
            padding: 20px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .content {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .calendar-section {
            flex: 1;
            min-width: 300px;
        }
        
        .booking-section {
            flex: 1;
            min-width: 300px;
        }
        
        .calendar {
            background: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }
        
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
        }
        
        .calendar-day {
            text-align: center;
            padding: 10px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s;
            min-height: 50px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            position: relative;
        }
        
        .calendar-day.header {
            font-weight: bold;
            background-color: var(--primary);
            color: white;
        }
        
        .calendar-day.weekend {
            background-color: #f0f0f0;
            color: #999;
        }
        
        .calendar-day.today {
            background-color: var(--accent);
            color: white;
        }
        
        .calendar-day.selected {
            background-color: var(--success);
            color: white;
        }
        
        .calendar-day.has-bookings {
            background-color: #ffeaa7;
        }
        
        .calendar-day.booked {
            background-color: var(--danger);
            color: white;
            cursor: not-allowed;
        }
        
        .day-number {
            font-size: 1.2em;
            font-weight: bold;
        }
        
        .booking-count {
            position: absolute;
            top: 5px;
            right: 5px;
            background: var(--accent);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 0.8em;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .holiday {
            font-size: 0.7rem;
            background: var(--warning);
            color: white;
            padding: 2px 4px;
            border-radius: 3px;
            margin-top: 4px;
        }
        
        .booking-form {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        
        button {
            background-color: var(--accent);
            color: white;
            border: none;
            padding: 14px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: background-color 0.3s;
            width: 100%;
            margin-top: 10px;
        }
        
        button:hover {
            background-color: var(--primary);
        }
        
        .time-slots {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 15px;
            margin-bottom: 20px;
            max-height: 300px;
            overflow-y: auto;
            padding: 10px;
            border: 1px solid #eee;
            border-radius: 4px;
        }
        
        .time-slot {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .time-slot:hover {
            transform: translateY(-2px);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .time-slot.selected {
            background: var(--success);
            color: white;
            border-color: var(--success);
        }
        
        .time-slot.booked {
            background: #eee;
            color: #999;
            cursor: not-allowed;
        }
        
        .time-slot.overlapping {
            background: var(--danger);
            color: white;
            cursor: not-allowed;
        }
        
        .bookings-list {
            margin-top: 20px;
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #eee;
            border-radius: 4px;
            padding: 10px;
        }
        
        .booking-item {
            padding: 10px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .booking-item:last-child {
            border-bottom: none;
        }
        
        .booking-info {
            flex: 1;
        }
        
        .booking-time {
            font-weight: bold;
            color: var(--primary);
        }
        
        .booking-name {
            font-size: 0.9em;
        }
        
        .delete-booking {
            background: var(--danger);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 5px 10px;
            cursor: pointer;
        }
        
        .time-selectors {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .time-selectors .form-group {
            flex: 1;
            margin-bottom: 0;
        }
        
        @media (max-width: 768px) {
            .content {
                flex-direction: column;
            }
            
            .calendar-grid {
                grid-template-columns: repeat(7, 1fr);
                font-size: 0.8em;
            }
            
            .calendar-day {
                padding: 5px;
                min-height: 40px;
            }
            
            .time-slots {
                grid-template-columns: repeat(1, 1fr);
            }
            
            .time-selectors {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Ministry Auditorium Booking System</h1>
            <p class="subtitle">Book our auditorium for meetings during weekdays</p>
        </header>
        
        <div class="tabs">
            <div class="tab active" data-tab="book">Book Auditorium</div>
            <div class="tab" data-tab="my-bookings">My Bookings</div>
            <div class="tab" data-tab="availability">Availability</div>
        </div>
        
        <div class="tab-content active" id="book">
            <div class="content">
                <div class="calendar-section">
                    <div class="calendar">
                        <div class="calendar-header">
                            <button id="prev-month">&lt; Previous</button>
                            <h2 id="current-month">April 2023</h2>
                            <button id="next-month">Next &gt;</button>
                        </div>
                        <div class="calendar-grid" id="calendar-days">
                            <!-- Calendar will be generated by JavaScript -->
                        </div>
                    </div>
                </div>
                
                <div class="booking-section">
                    <div class="booking-form">
                        <h2>Booking Details</h2>
                        <div class="form-group">
                            <label for="event-name">Event Name</label>
                            <input type="text" id="event-name" placeholder="Enter event name">
                        </div>
                        
                        <div class="form-group">
                            <label for="organizer">Organizer Name & Department</label>
                            <input type="text" id="organizer" placeholder="Your name and department">
                        </div>
                        
                        <div class="form-group">
                            <label for="date">Date</label>
                            <input type="text" id="date" readonly>
                        </div>
                        
                        <div class="time-selectors">
                            <div class="form-group">
                                <label for="start-time">Start Time</label>
                                <select id="start-time">
                                    <option value="">Select start time</option>
                                    <option value="08:00">8:00 AM</option>
                                    <option value="09:00">9:00 AM</option>
                                    <option value="10:00">10:00 AM</option>
                                    <option value="11:00">11:00 AM</option>
                                    <option value="12:00">12:00 PM</option>
                                    <option value="13:00">1:00 PM</option>
                                    <option value="14:00">2:00 PM</option>
                                    <option value="15:00">3:00 PM</option>
                                    <option value="16:00">4:00 PM</option>
                                    <option value="17:00">5:00 PM</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="end-time">End Time</label>
                                <select id="end-time">
                                    <option value="">Select end time</option>
                                    <option value="09:00">9:00 AM</option>
                                    <option value="10:00">10:00 AM</option>
                                    <option value="11:00">11:00 AM</option>
                                    <option value="12:00">12:00 PM</option>
                                    <option value="13:00">1:00 PM</option>
                                    <option value="14:00">2:00 PM</option>
                                    <option value="15:00">3:00 PM</option>
                                    <option value="16:00">4:00 PM</option>
                                    <option value="17:00">5:00 PM</option>
                                    <option value="18:00">6:00 PM</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="attendees">Number of Attendees</label>
                            <input type="number" id="attendees" min="1" value="10">
                        </div>
                        
                        <div class="form-group">
                            <label for="notes">Additional Requirements</label>
                            <textarea id="notes" rows="3" placeholder="Projector, whiteboard, video conferencing, etc."></textarea>
                        </div>
                        
                        <button id="confirm-booking">Confirm Booking</button>
                    </div>
                    
                    <div class="bookings-list" id="bookings-list">
                        <!-- Bookings will be listed here -->
                    </div>
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="my-bookings">
            <h2>My Bookings</h2>
            <div id="user-bookings">
                <!-- User bookings will be displayed here -->
            </div>
        </div>
        
        <div class="tab-content" id="availability">
            <h2>Auditorium Availability</h2>
            <div class="calendar">
                <div class="calendar-header">
                    <button id="availability-prev">&lt; Previous</button>
                    <h2 id="availability-month">April 2023</h2>
                    <button id="availability-next">Next &gt;</button>
                </div>
                <div class="calendar-grid" id="availability-days">
                    <!-- Availability calendar will be generated by JavaScript -->
                </div>
            </div>
            <div class="booking-form">
                <h3>Booking Instructions</h3>
                <ol>
                    <li>Select a date from the calendar to view available time slots</li>
                    <li>Choose your preferred start and end times</li>
                    <li>Fill in your event details and requirements</li>
                    <li>Submit your booking request</li>
                    <li>You will receive a confirmation of your booking</li>
                </ol>
                <p><strong>Note:</strong> Please cancel your booking if you no longer need the auditorium to free it up for others.</p>
            </div>
        </div>
    </div>

    <script>
        // Data storage
        let bookings = JSON.parse(localStorage.getItem('ministryAuditoriumBookings')) || [];
        let selectedDate = null;
        let currentView = 'book';
        let currentMonth = new Date();
        let availabilityMonth = new Date();
        
        // Sri Lankan public holidays for 2023 (sample data)
        const sriLankanHolidays = [
            { date: '2023-04-14', name: 'Sinhala and Tamil New Year' },
            { date: '2023-04-15', name: 'Sinhala and Tamil New Year Holiday' },
            { date: '2023-05-01', name: 'May Day' },
            { date: '2023-05-05', name: 'Eid ul-Fitr' },
            { date: '2023-05-19', name: 'Vesak Poya Day' },
            { date: '2023-05-20', name: 'Vesak Poya Holiday' },
        ];
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            renderCalendar();
            renderAvailabilityCalendar();
            setupEventListeners();
            updateBookingsList();
        });
        
        // Set up event listeners
        function setupEventListeners() {
            document.getElementById('prev-month').addEventListener('click', previousMonth);
            document.getElementById('next-month').addEventListener('click', nextMonth);
            document.getElementById('confirm-booking').addEventListener('click', confirmBooking);
            
            document.getElementById('availability-prev').addEventListener('click', previousAvailabilityMonth);
            document.getElementById('availability-next').addEventListener('click', nextAvailabilityMonth);
            
            // Tab navigation
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabName = tab.getAttribute('data-tab');
                    switchTab(tabName);
                });
            });
            
            // Time validation
            document.getElementById('start-time').addEventListener('change', validateTime);
            document.getElementById('end-time').addEventListener('change', validateTime);
        }
        
        // Render the calendar
        function renderCalendar() {
            const calendarDays = document.getElementById('calendar-days');
            const currentMonthElement = document.getElementById('current-month');
            
            // Clear previous calendar
            calendarDays.innerHTML = '';
            
            // Set current month text
            const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 
                               'July', 'August', 'September', 'October', 'November', 'December'];
            currentMonthElement.textContent = `${monthNames[currentMonth.getMonth()]} ${currentMonth.getFullYear()}`;
            
            // Create header for days of the week
            const daysOfWeek = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            daysOfWeek.forEach(day => {
                const dayElement = document.createElement('div');
                dayElement.classList.add('calendar-day', 'header');
                dayElement.textContent = day;
                calendarDays.appendChild(dayElement);
            });
            
            // Get first day of month and number of days in month
            const firstDay = new Date(currentMonth.getFullYear(), currentMonth.getMonth(), 1);
            const lastDay = new Date(currentMonth.getFullYear(), currentMonth.getMonth() + 1, 0);
            const daysInMonth = lastDay.getDate();
            
            // Add empty cells for days before the first day of the month
            for (let i = 0; i < firstDay.getDay(); i++) {
                const emptyDay = document.createElement('div');
                emptyDay.classList.add('calendar-day');
                calendarDays.appendChild(emptyDay);
            }
            
            // Add cells for each day of the month
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            for (let i = 1; i <= daysInMonth; i++) {
                const dayDate = new Date(currentMonth.getFullYear(), currentMonth.getMonth(), i);
                const dayElement = document.createElement('div');
                dayElement.classList.add('calendar-day');
                
                const dayNumber = document.createElement('div');
                dayNumber.classList.add('day-number');
                dayNumber.textContent = i;
                dayElement.appendChild(dayNumber);
                
                // Check if it's a weekend
                if (dayDate.getDay() === 0 || dayDate.getDay() === 6) {
                    dayElement.classList.add('weekend');
                }
                
                // Check if it's today
                if (dayDate.getDate() === today.getDate() && 
                    dayDate.getMonth() === today.getMonth() && 
                    dayDate.getFullYear() === today.getFullYear()) {
                    dayElement.classList.add('today');
                }
                
                // Check if it's a holiday
                const holiday = getHoliday(dayDate);
                if (holiday) {
                    const holidayElement = document.createElement('div');
                    holidayElement.classList.add('holiday');
                    holidayElement.textContent = holiday.name;
                    dayElement.appendChild(holidayElement);
                }
                
                // Check if it has bookings
                const dateBookings = getBookingsForDate(dayDate);
                if (dateBookings.length > 0) {
                    dayElement.classList.add('has-bookings');
                    
                    const bookingCount = document.createElement('div');
                    bookingCount.classList.add('booking-count');
                    bookingCount.textContent = dateBookings.length;
                    dayElement.appendChild(bookingCount);
                }
                
                // Add click event
                dayElement.addEventListener('click', () => selectDate(dayDate, dayElement));
                
                calendarDays.appendChild(dayElement);
            }
        }
        
        // Render availability calendar
        function renderAvailabilityCalendar() {
            const availabilityDays = document.getElementById('availability-days');
            const availabilityMonthElement = document.getElementById('availability-month');
            
            // Clear previous calendar
            availabilityDays.innerHTML = '';
            
            // Set current month text
            const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 
                               'July', 'August', 'September', 'October', 'November', 'December'];
            availabilityMonthElement.textContent = `${monthNames[availabilityMonth.getMonth()]} ${availabilityMonth.getFullYear()}`;
            
            // Create header for days of the week
            const daysOfWeek = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            daysOfWeek.forEach(day => {
                const dayElement = document.createElement('div');
                dayElement.classList.add('calendar-day', 'header');
                dayElement.textContent = day;
                availabilityDays.appendChild(dayElement);
            });
            
            // Get first day of month and number of days in month
            const firstDay = new Date(availabilityMonth.getFullYear(), availabilityMonth.getMonth(), 1);
            const lastDay = new Date(availabilityMonth.getFullYear(), availabilityMonth.getMonth() + 1, 0);
            const daysInMonth = lastDay.getDate();
            
            // Add empty cells for days before the first day of the month
            for (let i = 0; i < firstDay.getDay(); i++) {
                const emptyDay = document.createElement('div');
                emptyDay.classList.add('calendar-day');
                availabilityDays.appendChild(emptyDay);
            }
            
            // Add cells for each day of the month
            for (let i = 1; i <= daysInMonth; i++) {
                const dayDate = new Date(availabilityMonth.getFullYear(), availabilityMonth.getMonth(), i);
                const dayElement = document.createElement('div');
                dayElement.classList.add('calendar-day');
                
                const dayNumber = document.createElement('div');
                dayNumber.classList.add('day-number');
                dayNumber.textContent = i;
                dayElement.appendChild(dayNumber);
                
                // Check if it's a weekend
                if (dayDate.getDay() === 0 || dayDate.getDay() === 6) {
                    dayElement.classList.add('weekend');
                }
                
                // Check if it's a holiday
                const holiday = getHoliday(dayDate);
                if (holiday) {
                    const holidayElement = document.createElement('div');
                    holidayElement.classList.add('holiday');
                    holidayElement.textContent = holiday.name;
                    dayElement.appendChild(holidayElement);
                }
                
                // Check if it has bookings
                const dateBookings = getBookingsForDate(dayDate);
                if (dateBookings.length > 0) {
                    dayElement.classList.add('has-bookings');
                    
                    const bookingCount = document.createElement('div');
                    bookingCount.classList.add('booking-count');
                    bookingCount.textContent = dateBookings.length;
                    dayElement.appendChild(bookingCount);
                }
                
                availabilityDays.appendChild(dayElement);
            }
        }
        
        // Select a date
        function selectDate(date, element) {
            // Remove selected class from all days
            document.querySelectorAll('.calendar-day.selected').forEach(day => {
                day.classList.remove('selected');
            });
            
            // Add selected class to clicked day
            element.classList.add('selected');
            
            // Set the selected date
            selectedDate = date;
            
            // Update the date field in the form
            const dateString = formatDate(date);
            document.getElementById('date').value = dateString;
            
            // Update bookings list
            updateBookingsList();
        }
        
        // Confirm booking
        function confirmBooking() {
            if (!selectedDate) {
                alert('Please select a date');
                return;
            }
            
            const eventName = document.getElementById('event-name').value;
            const organizer = document.getElementById('organizer').value;
            const startTime = document.getElementById('start-time').value;
            const endTime = document.getElementById('end-time').value;
            const attendees = document.getElementById('attendees').value;
            const notes = document.getElementById('notes').value;
            
            if (!eventName || !organizer || !startTime || !endTime) {
                alert('Please fill in all required fields');
                return;
            }
            
            if (startTime >= endTime) {
                alert('End time must be after start time');
                return;
            }
            
            // Create booking object
            const booking = {
                id: Date.now(), // Unique ID
                date: formatDate(selectedDate),
                startTime: startTime,
                endTime: endTime,
                eventName,
                organizer,
                attendees,
                notes,
                timestamp: new Date().toISOString()
            };
            
            // Check for overlapping bookings
            if (hasOverlappingBooking(booking)) {
                alert('This time slot overlaps with an existing booking. Please choose a different time.');
                return;
            }
            
            // Add to bookings array
            bookings.push(booking);
            
            // Save to localStorage
            localStorage.setItem('ministryAuditoriumBookings', JSON.stringify(bookings));
            
            // Reset form
            document.getElementById('event-name').value = '';
            document.getElementById('organizer').value = '';
            document.getElementById('start-time').value = '';
            document.getElementById('end-time').value = '';
            document.getElementById('attendees').value = '10';
            document.getElementById('notes').value = '';
            
            // Update UI
            renderCalendar();
            renderAvailabilityCalendar();
            updateBookingsList();
            updateUserBookings();
            
            // Show success message
            alert('Booking successful! Your meeting has been scheduled.');
        }
        
        // Update bookings list
        function updateBookingsList() {
            const bookingsList = document.getElementById('bookings-list');
            
            if (!selectedDate) {
                bookingsList.innerHTML = '<p>Select a date to view bookings</p>';
                return;
            }
            
            const dateBookings = getBookingsForDate(selectedDate);
            
            if (dateBookings.length === 0) {
                bookingsList.innerHTML = '<p>No bookings for this date</p>';
                return;
            }
            
            // Clear current list
            bookingsList.innerHTML = '';
            
            // Add each booking to the list
            dateBookings.forEach(booking => {
                const bookingElement = document.createElement('div');
                bookingElement.classList.add('booking-item');
                
                const bookingInfo = document.createElement('div');
                bookingInfo.classList.add('booking-info');
                
                const timeElement = document.createElement('div');
                timeElement.classList.add('booking-time');
                timeElement.textContent = `${formatTimeDisplay(booking.startTime)} - ${formatTimeDisplay(booking.endTime)}`;
                
                const nameElement = document.createElement('div');
                nameElement.classList.add('booking-name');
                nameElement.textContent = `${booking.eventName} (by ${booking.organizer})`;
                
                bookingInfo.appendChild(timeElement);
                bookingInfo.appendChild(nameElement);
                
                const deleteButton = document.createElement('button');
                deleteButton.classList.add('delete-booking');
                deleteButton.textContent = 'Delete';
                deleteButton.addEventListener('click', () => deleteBooking(booking.id));
                
                bookingElement.appendChild(bookingInfo);
                bookingElement.appendChild(deleteButton);
                
                bookingsList.appendChild(bookingElement);
            });
        }
        
        // Update user bookings
        function updateUserBookings() {
            const userBookingsContainer = document.getElementById('user-bookings');
            userBookingsContainer.innerHTML = '';
            
            if (bookings.length === 0) {
                userBookingsContainer.innerHTML = '<p>You have no bookings</p>';
                return;
            }
            
            // Group bookings by date
            const bookingsByDate = {};
            bookings.forEach(booking => {
                if (!bookingsByDate[booking.date]) {
                    bookingsByDate[booking.date] = [];
                }
                bookingsByDate[booking.date].push(booking);
            });
            
            // Create HTML for each date
            for (const date in bookingsByDate) {
                const dateHeader = document.createElement('h3');
                dateHeader.textContent = formatDateDisplay(date);
                userBookingsContainer.appendChild(dateHeader);
                
                const dateBookings = bookingsByDate[date];
                dateBookings.forEach(booking => {
                    const bookingElement = document.createElement('div');
                    bookingElement.classList.add('booking-item');
                    
                    const bookingInfo = document.createElement('div');
                    bookingInfo.classList.add('booking-info');
                    
                    const timeElement = document.createElement('div');
                    timeElement.classList.add('booking-time');
                    timeElement.textContent = `${formatTimeDisplay(booking.startTime)} - ${formatTimeDisplay(booking.endTime)}`;
                    
                    const nameElement = document.createElement('div');
                    nameElement.classList.add('booking-name');
                    nameElement.textContent = `${booking.eventName} (${booking.attendees} attendees)`;
                    
                    bookingInfo.appendChild(timeElement);
                    bookingInfo.appendChild(nameElement);
                    
                    const deleteButton = document.createElement('button');
                    deleteButton.classList.add('delete-booking');
                    deleteButton.textContent = 'Delete';
                    deleteButton.addEventListener('click', () => deleteBooking(booking.id));
                    
                    bookingElement.appendChild(bookingInfo);
                    bookingElement.appendChild(deleteButton);
                    
                    userBookingsContainer.appendChild(bookingElement);
                });
            }
        }
        
        // Delete a booking
        function deleteBooking(id) {
            if (confirm('Are you sure you want to delete this booking?')) {
                bookings = bookings.filter(booking => booking.id !== id);
                localStorage.setItem('ministryAuditoriumBookings', JSON.stringify(bookings));
                renderCalendar();
                renderAvailabilityCalendar();
                updateBookingsList();
                updateUserBookings();
            }
        }
        
        // Switch tab
        function switchTab(tabName) {
            currentView = tabName;
            
            // Update tab buttons
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`.tab[data-tab="${tabName}"]`).classList.add('active');
            
            // Update tab content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(tabName).classList.add('active');
            
            // Update content if needed
            if (tabName === 'my-bookings') {
                updateUserBookings();
            } else if (tabName === 'availability') {
                renderAvailabilityCalendar();
            }
        }
        
        // Navigation functions
        function previousMonth() {
            currentMonth.setMonth(currentMonth.getMonth() - 1);
            renderCalendar();
        }
        
        function nextMonth() {
            currentMonth.setMonth(currentMonth.getMonth() + 1);
            renderCalendar();
        }
        
        function previousAvailabilityMonth() {
            availabilityMonth.setMonth(availabilityMonth.getMonth() - 1);
            renderAvailabilityCalendar();
        }
        
        function nextAvailabilityMonth() {
            availabilityMonth.setMonth(availabilityMonth.getMonth() + 1);
            renderAvailabilityCalendar();
        }
        
        // Validate time selection
        function validateTime() {
            const startTime = document.getElementById('start-time').value;
            const endTime = document.getElementById('end-time').value;
            
            if (startTime && endTime && startTime >= endTime) {
                alert('End time must be after start time');
                document.getElementById('end-time').value = '';
            }
        }
        
        // Utility functions
        function formatDate(date) {
            const year = date.getFullYear();
            const month = (date.getMonth() + 1).toString().padStart(2, '0');
            const day = date.getDate().toString().padStart(2, '0');
            return `${year}-${month}-${day}`;
        }
        
        function formatDateDisplay(dateString) {
            const [year, month, day] = dateString.split('-');
            const date = new Date(year, month - 1, day);
            return date.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
        }
        
        function formatTimeDisplay(time) {
            const [hours, minutes] = time.split(':');
            const hourNum = parseInt(hours);
            const period = hourNum >= 12 ? 'PM' : 'AM';
            const displayHour = hourNum % 12 || 12;
            return `${displayHour}:${minutes} ${period}`;
        }
        
        function getBookingsForDate(date) {
            const dateString = formatDate(date);
            return bookings.filter(booking => booking.date === dateString);
        }
        
        function hasOverlappingBooking(newBooking) {
            return bookings.some(booking => {
                if (booking.date !== newBooking.date) return false;
                
                const newStart = newBooking.startTime;
                const newEnd = newBooking.endTime;
                const existingStart = booking.startTime;
                const existingEnd = booking.endTime;
                
                // Check if the new booking overlaps with existing booking
                return (newStart >= existingStart && newStart < existingEnd) ||
                       (newEnd > existingStart && newEnd <= existingEnd) ||
                       (newStart <= existingStart && newEnd >= existingEnd);
            });
        }
        
        function getHoliday(date) {
            const dateString = formatDate(date);
            return sriLankanHolidays.find(holiday => holiday.date === dateString);
        }
        
        // Initialize with today's date
        const today = new Date();
        setTimeout(() => {
            const todayElement = document.querySelector('.calendar-day.today');
            if (todayElement) {
                selectDate(today, todayElement);
            }
        }, 100);
    </script>
</body>
</html>